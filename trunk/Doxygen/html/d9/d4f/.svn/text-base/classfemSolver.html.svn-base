<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>2D Unsteady Diffusion Solver: femSolver Class Reference</title>

<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />

<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">2D Unsteady Diffusion Solver
   &#160;<span id="projectnumber">Serial Version</span>
   </div>
   <div id="projectbrief">Finite Element based 2D Unsteady Heat Diffusion Solver.</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">femSolver Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="femSolver" -->
<p>This class defines the solver control and solver member functions.  
 <a href="../../d9/d4f/classfemSolver.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../d4/d20/solver_8h_source.html">solver.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for femSolver:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/dd0/classfemSolver__coll__graph.png" border="0" usemap="#femSolver_coll__map" alt="Collaboration graph"/></div>
<map name="femSolver_coll__map" id="femSolver_coll__map">
<area shape="rect" id="node2" href="../../d0/dbb/classtriMesh.html" title="This class defines MESH DATA STRUCTURE." alt="" coords="148,101,212,131"/><area shape="rect" id="node4" href="../../d6/d52/classtriNode.html" title="This class defines NODE LEVEL DATA STRUCTURE." alt="" coords="5,5,69,35"/><area shape="rect" id="node6" href="../../d2/dc0/classtriMasterElement.html" title="This class defines LINEAR TRIANGULAR MASTER ELEMENT." alt="" coords="93,5,213,35"/><area shape="rect" id="node8" href="../../d2/da0/classtriElement.html" title="This class defines ELEMENT LEVEL DATA STRUCTURE." alt="" coords="237,5,317,35"/><area shape="rect" id="node10" href="../../d2/dc5/classinputSettings.html" title="This class contains SETTINGS DATA STRUCTURE." alt="" coords="289,101,388,131"/><area shape="rect" id="node12" href="../../d1/d8a/classbndc.html" title="This class contains BOUNDARY CONDITION SPECIFICATION." alt="" coords="341,5,392,35"/></map>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>

<p><a href="../../d9/d87/classfemSolver-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d4f/classfemSolver.html#aa882e587211464f633f5bd5f9473006d">femSolver</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">DEFAULT CONSTRUCTOR.  <a href="#aa882e587211464f633f5bd5f9473006d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d4f/classfemSolver.html#af9c113b5d6cd5bea68b01de3e065924a">~femSolver</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">DESTRUCTOR.  <a href="#af9c113b5d6cd5bea68b01de3e065924a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d4f/classfemSolver.html#a9f2de938d338dc2f88c3249fe66f1685">solverControl</a> (<a class="el" href="../../d2/dc5/classinputSettings.html">inputSettings</a> *, <a class="el" href="../../d0/dbb/classtriMesh.html">triMesh</a> *)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">INTERFACE FUNCTION.  <a href="#a9f2de938d338dc2f88c3249fe66f1685"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d4f/classfemSolver.html#aba175e4a7674e7782f836edc2ba04ba2">calculateJacobian</a> (const int)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">PRIVATE METHODS.  <a href="#aba175e4a7674e7782f836edc2ba04ba2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d4f/classfemSolver.html#a0387ee820a11820e385888e7bab36804">calculateElementMatrices</a> (const int)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d4f/classfemSolver.html#a0f34093a61a70b1a62fd0249a55fc276">applyBoundaryConditions</a> (const int)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d4f/classfemSolver.html#a037436ec93945a35a6086df6b0ac76d5">globalAssembly</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d4f/classfemSolver.html#a9a6896c81253ca6777a2098a0912581d">explicitSolver</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/dc5/classinputSettings.html">inputSettings</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d4f/classfemSolver.html#a5e292644a47b63934f20c16c4d14c60c">settings</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">PRIVATE VARIABLES.  <a href="#a5e292644a47b63934f20c16c4d14c60c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/dbb/classtriMesh.html">triMesh</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d4f/classfemSolver.html#acf4e55a79c9fdab164ed7040b2e29404">mesh</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>This class defines the solver control and solver member functions. </p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aa882e587211464f633f5bd5f9473006d"></a><!-- doxytag: member="femSolver::femSolver" ref="aa882e587211464f633f5bd5f9473006d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d4f/classfemSolver.html#aa882e587211464f633f5bd5f9473006d">femSolver::femSolver</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>DEFAULT CONSTRUCTOR. </p>

</div>
</div>
<a class="anchor" id="af9c113b5d6cd5bea68b01de3e065924a"></a><!-- doxytag: member="femSolver::~femSolver" ref="af9c113b5d6cd5bea68b01de3e065924a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d4f/classfemSolver.html#af9c113b5d6cd5bea68b01de3e065924a">femSolver::~femSolver</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>DESTRUCTOR. </p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a0f34093a61a70b1a62fd0249a55fc276"></a><!-- doxytag: member="femSolver::applyBoundaryConditions" ref="a0f34093a61a70b1a62fd0249a55fc276" args="(const int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d9/d4f/classfemSolver.html#a0f34093a61a70b1a62fd0249a55fc276">femSolver::applyBoundaryConditions</a> </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>e</em></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Loop over Faces of element 'e'</p>
<p>Access the local indices for nodes of the current Face</p>
<p>Access the connectivity of nodes of the Face</p>
<p>Dirichlet</p>
<p>Set the temperature values of the nodes of the element on boundaries</p>
<p>Get the temperature at the node. Default is Intial value.</p>
<p>Check if Temperature at some node is already set to some value. This can be the case with nodes which lie on multiple boundaries. If this is the case, take average of the both values</p>
<p>Make the corresponding entries in element level K matrix = 1 and rest equate to zero in the same row</p>
<p>Copy row correspoding to unknown temperature to modified K</p>
<p>Set B</p>
<p>Set K</p>
<p>Flag the nodes on Dirichlet boundary and assign BC type</p>
<p>Neumann</p>
<p>Get the X and Y coordinates of the nodes on boundary</p>
<p>Calculate length of the edge</p>
<p>Set the flux values at the nodes of the element on boundaries Get the temperature at the node. Default is Intial value.</p>
<p>Check if Temperature at some node is already set to some value. If this is the case, we don't apply any flux value to that node, because we already know the value of temperature and we don't solve for it.</p>
<p>Robin (Mixed)</p>
<p>Get Heat Transfer Coefficient</p>
<p>Get the X and Y coordinates of the nodes on boundary</p>
<p>Calculate length of the edge</p>
<p>Set the flux values at the nodes of the element on boundaries Get the temperature at the node. Default is Intial value.</p>
<p>Check if Temperature at some node is already set to some value. If this is the case, we don't apply any flux value to that node, because we already know the value of temperature and we don't solve for it.</p>
<p>Make the coresponding changes in element level K matrix</p>
<p>Loop over faces end </p>

</div>
</div>
<a class="anchor" id="a0387ee820a11820e385888e7bab36804"></a><!-- doxytag: member="femSolver::calculateElementMatrices" ref="a0387ee820a11820e385888e7bab36804" args="(const int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d9/d4f/classfemSolver.html#a0387ee820a11820e385888e7bab36804">femSolver::calculateElementMatrices</a> </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>e</em></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Access the derivatives of shape functions dSdXi and dSdEta are constant for the reference element so it is sufficient to access values for 0th Master element.</p>
<p>Get Diffusion coefficient</p>
<p>Access the coordinates of the nodes of the element 'e'</p>
<p>Get absolute value of determinant of Jacobian</p>
<p>Calculate the right hand side source term</p>
<p>Gauss Quadrature rule for integration</p>
<p>Access weight for current gauss point</p>
<p>Access Shape function values</p>
<p>Access derivatives of shape functions</p>
<p>Evaluate dSdX and dSdY at Gauss Quadrature Points.</p>
<p>Construct the element matrix</p>
<p>Construct the mass matrix</p>
<p>Construct the element level Source vector</p>
<p>Set the element matrix in element level structure</p>
<p>Lumping of Mass matrix for all elements</p>
<p>Initialize sums</p>
<p>Lumped mass matrix is diagonal matrix so only diagonal is stored</p>
<p>Sum of all elements</p>
<p>Lumped local mass matrix (only diagonal elements)</p>
<p>Set the mass matrix in element level structure</p>
<p>Set the element matrix in element level structure </p>

</div>
</div>
<a class="anchor" id="aba175e4a7674e7782f836edc2ba04ba2"></a><!-- doxytag: member="femSolver::calculateJacobian" ref="aba175e4a7674e7782f836edc2ba04ba2" args="(const int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d9/d4f/classfemSolver.html#aba175e4a7674e7782f836edc2ba04ba2">femSolver::calculateJacobian</a> </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>e</em></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>PRIVATE METHODS. </p>
<p>Access the coordinates of the nodes of the element 'e'</p>
<p>Access the derivatives of shape functions dSdXi and dSdEta are constant for the reference element so it is sufficient to access values for 0th Master element.</p>
<p>Matrix-Matrix multiplication for calculation of Jacobian Matrix _ _ | J[0] J[1] | J = | | |_J[2] J[3]_|</p>
<p>Set the Jacobian matrix for each element</p>
<p>Calculate determinant of J</p>
<p>Invert Jacobian Matrix by Adjoint method</p>
<p>Set the Inverse of Jacobian matrix for each element </p>

</div>
</div>
<a class="anchor" id="a9a6896c81253ca6777a2098a0912581d"></a><!-- doxytag: member="femSolver::explicitSolver" ref="a9a6896c81253ca6777a2098a0912581d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d9/d4f/classfemSolver.html#a9a6896c81253ca6777a2098a0912581d">femSolver::explicitSolver</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Element level variables</p>
<p>Node level variables</p>
<p>Time loop start</p>
<p>Write solution at certain time steps</p>
<p>Initialize node level variables</p>
<p>Loop through all elements</p>
<p>Construct element level Right Hand Side Access the connectivity of the element 'e'</p>
<p>K[i][j]*T[j]</p>
<p>dt*(F + B - K*T)</p>
<p>Access lumped mass matrix</p>
<p>M[3][3]*T[3] + dt(F + B - K*T)</p>
<p>Assemble global Diagonal Mass matrix and RHS</p>
<p>element loop end</p>
<p>Loop through all nodes, calculate and set the temperature (Also check if it reached steady state)</p>
<p>Set the calculated temperature to the nodes which are not on the Dirichlet Boundary</p>
<p>Increase time by dt</p>
<p>Time loop end </p>

</div>
</div>
<a class="anchor" id="a037436ec93945a35a6086df6b0ac76d5"></a><!-- doxytag: member="femSolver::globalAssembly" ref="a037436ec93945a35a6086df6b0ac76d5" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d9/d4f/classfemSolver.html#a037436ec93945a35a6086df6b0ac76d5">femSolver::globalAssembly</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a9f2de938d338dc2f88c3249fe66f1685"></a><!-- doxytag: member="femSolver::solverControl" ref="a9f2de938d338dc2f88c3249fe66f1685" args="(inputSettings *, triMesh *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d9/d4f/classfemSolver.html#a9f2de938d338dc2f88c3249fe66f1685">femSolver::solverControl</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/dc5/classinputSettings.html">inputSettings</a> *&#160;</td>
          <td class="paramname"><em>argSettings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/dbb/classtriMesh.html">triMesh</a> *&#160;</td>
          <td class="paramname"><em>argMesh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>INTERFACE FUNCTION. </p>
<p>Calculate Jacobian for all elements</p>
<p>Calculate element matrices for all elements</p>
<p>Apply the boundary conditions</p>
<p>Solve the equation system </p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="acf4e55a79c9fdab164ed7040b2e29404"></a><!-- doxytag: member="femSolver::mesh" ref="acf4e55a79c9fdab164ed7040b2e29404" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/dbb/classtriMesh.html">triMesh</a>* <a class="el" href="../../d9/d4f/classfemSolver.html#acf4e55a79c9fdab164ed7040b2e29404">femSolver::mesh</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a5e292644a47b63934f20c16c4d14c60c"></a><!-- doxytag: member="femSolver::settings" ref="a5e292644a47b63934f20c16c4d14c60c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/dc5/classinputSettings.html">inputSettings</a>* <a class="el" href="../../d9/d4f/classfemSolver.html#a5e292644a47b63934f20c16c4d14c60c">femSolver::settings</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>PRIVATE VARIABLES. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d4/d20/solver_8h_source.html">solver.h</a></li>
<li><a class="el" href="../../d6/d94/solver_8cpp.html">solver.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Fri Jan 31 2014 18:39:05 for 2D Unsteady Diffusion Solver by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
